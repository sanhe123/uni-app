{"version":3,"sources":["webpack:///E:/self/uni-app/yuedu/pages/write/write.vue?b2f4","webpack:///E:/self/uni-app/yuedu/pages/write/write.vue?6245","webpack:///E:/self/uni-app/yuedu/pages/write/write.vue?7f6c","webpack:///E:/self/uni-app/yuedu/pages/write/write.vue?54ab","webpack:///E:/self/uni-app/yuedu/pages/write/write.vue"],"names":["loginRes","_self","signModel","require","data","title","artList","inputContent","needUploadImg","uploadIndex","caties","currentCateIndex","catiesFromApi","sedCateIndex","onLoad","sign","apiServer","checkLogin","uni","request","url","method","success","res","status","categories","k","push","methods","submit","console","log","content","detail","value","artText","length","showToast","icon","type","cateChange","e","sedIndex","cateName","addImg","chooseImage","count","sizeType","tempFilePaths","removeImg","target","dataset","index","showModal","confirm","splice","deleteText","submitNow","i","tmpurl","indexID","uploadImg","getStorageSync","showLoading","header","JSON","stringify","uid","random","cate","setTimeout","switchTab","fail","complete","uploader","uploadFile","filePath","name","uploadFileRes","parse","staticServer","hideLoading"],"mappings":"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","file":"pages/write/write.js","sourcesContent":["import { render, staticRenderFns } from \"./write.vue?vue&type=template&id=10b28e86&\"\nimport script from \"./write.vue?vue&type=script&lang=js&\"\nexport * from \"./write.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('10b28e86', component.options)\n    } else {\n      api.reload('10b28e86', component.options)\n    }\n    module.hot.accept(\"./write.vue?vue&type=template&id=10b28e86&\", function () {\n      api.rerender('10b28e86', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"E:/self/uni-app/yuedu/pages/write/write.vue\"\nexport default component.exports","export * from \"-!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./write.vue?vue&type=template&id=10b28e86&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./write.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Administrator\\\\Desktop\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./write.vue?vue&type=script&lang=js&\"","//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n\r\nvar loginRes, _self;\r\nvar signModel = require('../../common/js/sign.js');\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttitle: '',\r\n\t\t\tartList: [],\r\n\t\t\tinputContent: '',\r\n\t\t\tneedUploadImg: [],\r\n\t\t\tuploadIndex: 0,\r\n\t\t\t//分类\r\n\t\t\tcaties: ['点击选择'],\r\n\t\t\tcurrentCateIndex: 0,\r\n\t\t\tcatiesFromApi: [], //存储接口请求分类数据\r\n\t\t\t// 记录真实选择的api接口数据的分类id\r\n\t\t\tsedCateIndex: 0\r\n\t\t};\r\n\t},\r\n\tonLoad() {\r\n\t\t_self = this;\r\n\t\tsignModel.sign(this.apiServer);\r\n\t\tloginRes = this.checkLogin('../write/write', 2);\r\n\t\tif (!loginRes) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// 加载文章分类\r\n\t\tuni.request({\r\n\t\t\turl: this.apiServer + 'category&m=index',\r\n\t\t\tmethod: 'GET',\r\n\t\t\tsuccess: res => {\r\n\t\t\t\tif (res.data.status == 'ok') {\r\n\t\t\t\t\t// 把数据格式整理为 picker 支持的格式 ['分类名', ...]\r\n\t\t\t\t\tvar categories = res.data.data;\r\n\t\t\t\t\tfor (var k in categories) {\r\n\t\t\t\t\t\t_self.caties.push(categories[k]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 记录分类信息\r\n\t\t\t\t\t_self.catiesFromApi = categories;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\t//添加文本数据\r\n\t\tsubmit(res) {\r\n\t\t\tconsole.log(res);\r\n\t\t\tvar content = res.detail.value.artText;\r\n\t\t\tif (content.length < 1) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请输入内容',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.artList.push({ type: 'text', content: content });\r\n\t\t\tconsole.log(this.artList);\r\n\t\t\tthis.inputContent = '';\r\n\t\t},\r\n\t\t//选择分类\r\n\t\tcateChange(e) {\r\n\t\t\tconsole.log(e);\r\n\t\t\t//获取用户选中的索引\r\n\t\t\tvar sedIndex = e.detail.value;\r\n\t\t\tthis.currentCateIndex = sedIndex;\r\n\t\t\tif (sedIndex < 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar cateName = this.caties[sedIndex];\r\n\t\t\tfor (var k in this.catiesFromApi) {\r\n\t\t\t\tif (cateName == this.catiesFromApi[k]) {\r\n\t\t\t\t\tthis.sedCateIndex = k;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.currentCateIndex = sedIndex;\r\n\t\t},\r\n\t\t//添加图片\r\n\t\taddImg() {\r\n\t\t\tvar _self = this;\r\n\t\t\tuni.chooseImage({\r\n\t\t\t\tcount: 1, //一次上传一张\r\n\t\t\t\tsizeType: ['compressed'], //压缩\r\n\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t_self.artList.push({ type: 'image', content: res.tempFilePaths[0] });\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//删除图片\r\n\t\tremoveImg(e) {\r\n\t\t\tvar _self = this;\r\n\t\t\tvar sedIndex = e.target.dataset.index;\r\n\t\t\tuni.showModal({\r\n\t\t\t\tcontent: '确定要删除此图片吗',\r\n\t\t\t\ttitle: '提示',\r\n\t\t\t\tsuccess(e) {\r\n\t\t\t\t\tif (e.confirm) {\r\n\t\t\t\t\t\t_self.artList.splice(sedIndex, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tdeleteText(e) {\r\n\t\t\tvar _self = this;\r\n\t\t\tvar sedIndex = e.target.dataset.index;\r\n\t\t\tuni.showModal({\r\n\t\t\t\tcontent: '确定要删除此文本吗',\r\n\t\t\t\ttitle: '提示',\r\n\t\t\t\tsuccess(e) {\r\n\t\t\t\t\tif (e.confirm) {\r\n\t\t\t\t\t\t_self.artList.splice(sedIndex, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tsubmitNow() {\r\n\t\t\t//检查提交数据是否符合规则\r\n\t\t\tif (this.title.length < 2) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请输入标题',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.artList.length < 1) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请填写文章内容',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.sedCateIndex < 1) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请选择分类',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//整理需要上传的图片\r\n\t\t\tthis.needUploadImg = [];\r\n\t\t\tfor (let i = 0; i < this.artList.length; i++) {\r\n\t\t\t\tif (this.artList[i].type == 'image') {\r\n\t\t\t\t\tthis.needUploadImg.push({ tmpurl: this.artList[i].content, indexID: i });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.uploadImg();\r\n\t\t},\r\n\t\tuploadImg() {\r\n\t\t\tvar sign = uni.getStorageSync('sign');\r\n\t\t\t_self = this;\r\n\t\t\tif (this.needUploadImg.length < 1 || this.uploadIndex >= this.needUploadImg.length) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '正在提交'\r\n\t\t\t\t});\r\n\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: _self.apiServer + 'art&m=add',\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theader: { 'content-type': 'application/x-www-form-urlencoded' },\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\ttitle: _self.title,\r\n\t\t\t\t\t\tcontent: JSON.stringify(_self.artList),\r\n\t\t\t\t\t\tuid: loginRes[0],\r\n\t\t\t\t\t\trandom: loginRes[1],\r\n\t\t\t\t\t\tcate: _self.sedCateIndex,\r\n\t\t\t\t\t\tsign: sign\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\tif (res.data.status == 'ok') {\r\n\t\t\t\t\t\t\tuni.showToast({ title: '提交成功', icon: 'none' });\r\n\t\t\t\t\t\t\t_self.artList = [];\r\n\t\t\t\t\t\t\t// 清空数据\r\n\t\t\t\t\t\t\tsignModel.sign(_self.apiServer);\r\n\t\t\t\t\t\t\t// 防止数据缓存\r\n\t\t\t\t\t\t\t_self.currentCateIndex = 0;\r\n\t\t\t\t\t\t\t_self.sedCateIndex = 0;\r\n\t\t\t\t\t\t\t_self.needUploadImg = [];\r\n\t\t\t\t\t\t\t_self.title = '';\r\n\t\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\t\t\turl: '../my/my'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({ title: res.data.data, icon: 'none' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {},\r\n\t\t\t\t\tcomplete: () => {}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '图片上传中'\r\n\t\t\t\t});\r\n\t\t\t\t//将本地临时图片上传到服务器\r\n\t\t\t\tvar uploader = uni.uploadFile({\r\n\t\t\t\t\turl: _self.apiServer + 'uploadImg&m=index',\r\n\t\t\t\t\tfilePath: _self.needUploadImg[_self.uploadIndex].tmpurl,\r\n\t\t\t\t\tname: 'file',\r\n\t\t\t\t\tsuccess(uploadFileRes) {\r\n\t\t\t\t\t\tconsole.log(uploadFileRes.data);\r\n\t\t\t\t\t\tuploadFileRes = JSON.parse(uploadFileRes.data);\r\n\t\t\t\t\t\tif (uploadFileRes.status != 'ok') {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '图片上传失败，请重试',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//将已上传的文件地址赋值给文章数据\r\n\t\t\t\t\t\tvar index = _self.needUploadImg[_self.uploadIndex].indexID;\r\n\t\t\t\t\t\t_self.artList[index].content = _self.staticServer + uploadFileRes.data;\r\n\t\t\t\t\t\t_self.uploadIndex++;\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t_self.uploadImg();\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n"],"sourceRoot":""}